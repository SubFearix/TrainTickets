Система бронирования железнодорожных билетов

Введение

Проект "Railway Ticket Booking System" представляет собой комплексное клиент-серверное приложение, разработанное на языке C++ с использованием фреймворка Qt. Система предназначена для эффективного поиска, бронирования и управления железнодорожными билетами, предоставляя пользователям интуитивно понятный интерфейс и надежный функционал.

Система построена на классической двухкомпонентной архитектуре. Серверная часть отвечает за реализацию всей бизнес-логики, обработку запросов, взаимодействие с базой данных и обеспечение безопасности. Клиентская часть представляет собой десктопное приложение с графическим интерфейсом (GUI), которое обеспечивает удобное взаимодействие пользователя с системой.


--------------------------------------------------------------------------------


1. Ключевые функциональные возможности

Клиентское приложение

* Регистрация и аутентификация: Пользователи могут создавать новые учетные записи и входить в систему, используя свои учетные данные (email и пароль).
* Верификация по Email: Для подтверждения подлинности пользователя реализован процесс верификации электронной почты. После регистрации на указанный адрес отправляется уникальный код, который необходимо ввести для активации учетной записи.
* Поиск поездов: Система позволяет выполнять поиск доступных поездов по станциям отправления, прибытия и дате поездки, предоставляя пользователю актуальное расписание.
* Визуальный выбор места: После выбора поезда пользователю доступна интерактивная схема вагона (Плацкарт, Купе, Сидячий), на которой можно выбрать конкретное свободное место.
* Бронирование билета: Выбранное место можно забронировать на 15 минут. Если оплата не поступает в течение этого времени, сервер автоматически аннулирует бронирование в ходе периодической очистки просроченных заказов, изменяя статус билета на 'expired'.
* Оплата билета: Реализован процесс оплаты забронированного билета, после которого статус билета меняется на "оплачен".
* Управление билетами: В личном кабинете пользователь может просматривать список своих активных и архивных билетов, а также отменять бронирование или уже купленный билет.
* Управление профилем: Пользователи могут просматривать данные своего профиля, а также изменять пароль с соблюдением требований безопасности (длина не менее 8 символов, наличие как минимум одной заглавной буквы, одной цифры и одного специального символа).

Серверное приложение (системные функции)

* Обработка подключений: Сервер управляет TCP-соединениями от клиентов, включая ограничение на максимальное число одновременных подключений для обеспечения стабильности.
* Безопасность: Система обеспечивает высокий уровень безопасности: пароли хешируются с использованием "соли", а учетные записи автоматически блокируются на 5 минут после 5 неудачных попыток входа. Управление доступом осуществляется через сессионные токены, которые выдаются после успешного входа. Каждый последующий запрос, требующий аутентификации, проверяется на сервере: обработчик ClientHandler валидирует токен сессии перед выполнением команды, обеспечивая тем самым безопасность данных пользователя.
* Взаимодействие с БД: Сервер инкапсулирует все операции с базой данных PostgreSQL. При первом запуске он автоматически создает необходимую схему и таблицы. В дальнейшем он управляет всеми CRUD-операциями и выполняет сложные запросы для поиска и фильтрации данных.
* Аудит и логирование: Все ключевые действия пользователей, такие как вход в систему, попытки входа, бронирование, оплата и ошибки, записываются в специальную таблицу audit_logs для последующего анализа и мониторинга.
* Генерация PDF-билетов: После успешной оплаты билета система автоматически генерирует PDF-файл с полной информацией о поездке, включая QR-код.
* Email-уведомления: Сгенерированный PDF-билет отправляется на электронную почту пользователя в качестве вложения, обеспечивая удобный доступ к проездному документу.

2. Архитектура системы

Система построена по классической клиент-серверной архитектуре. Такое разделение позволяет эффективно изолировать пользовательский интерфейс от бизнес-логики и управления данными, что повышает масштабируемость, безопасность и упрощает дальнейшую поддержку и развитие проекта.

Сервер

Серверная часть представляет собой многопоточное TCP-приложение, написанное на C++ с использованием фреймворка Qt. Оно асинхронно обрабатывает запросы от множества клиентов, обеспечивая стабильную и быструю работу. Ключевые компоненты сервера:

* ApiServer: Основной класс сервера, который прослушивает указанный порт и принимает входящие TCP-соединения от клиентов. Для каждого нового подключения он создает отдельный обработчик.
* ClientHandler: Класс, отвечающий за обработку логики одного клиента. Он получает запросы, парсит их, выполняет соответствующие команды и отправляет ответы. Для команд, требующих аутентификации, ClientHandler проверяет валидность сессионного токена, предоставленного клиентом.
* Database: Реализован как синглтон (Singleton) для инкапсуляции всех операций с базой данных PostgreSQL. Он предоставляет единый интерфейс для выполнения запросов, управления транзакциями и обработки ошибок, связанных с БД.

Клиент

Клиентская часть — это десктопное приложение, разработанное на C++ с использованием модуля Qt Widgets. Оно предоставляет пользователю графический интерфейс для взаимодействия с системой. Ключевые компоненты клиента:

* ApiClient: Синглтон, отвечающий за все сетевое взаимодействие с сервером. Он устанавливает соединение, отправляет команды в формате JSON и асинхронно обрабатывает ответы, уведомляя другие компоненты приложения через сигналы.
* MainWindow: Главное окно приложения, которое использует QStackedWidget для управления и переключения между различными экранами (виджетами). Этот подход позволяет реализовать логику одностраничного приложения (SPA) в десктопной среде.
* Виджеты (LoginWidget, MainMenuWidget, SeatSelectionWidget и т.д.): Модульные и переиспользуемые компоненты пользовательского интерфейса. Каждый виджет отвечает за конкретную функциональную часть приложения, например, за экран входа, главное меню или выбор места в вагоне.

Протокол взаимодействия

Взаимодействие между клиентом и сервером происходит по протоколу TCP. Для обмена данными используется текстовый формат JSON, что обеспечивает гибкость и читаемость сообщений. Каждый запрос от клиента представляет собой JSON-объект, который обязательно содержит поле "command" (строка с названием команды) и опциональное поле "data" (объект с параметрами для этой команды). Сервер обрабатывает команду и возвращает JSON-ответ, содержащий статус выполнения и запрошенные данные.

3. Технологический стек

Для реализации проекта был выбран набор проверенных и надежных технологий, обеспечивающих высокую производительность, кроссплатформенность и удобство разработки. В этом разделе перечислены все основные языки программирования, фреймворки и библиотеки, использованные в системе.

* Язык программирования:
  * C++: Основной язык программирования, выбранный за его производительность и широкие возможности системного программирования.
* Фреймворк:
  * Qt Framework: Используется как для серверной, так и для клиентской части. Задействованы следующие ключевые модули:
    * QtCore: для базовых классов, работы с потоками и системы сигналов-слотов.
    * QtNetwork: для реализации сетевого взаимодействия (TCP-клиент и сервер).
    * QtSql: для интеграции с базой данных PostgreSQL.
    * QtWidgets: для создания графического пользовательского интерфейса в клиентском приложении.
* База данных:
  * PostgreSQL: Мощная и надежная объектно-реляционная система управления базами данных, используемая для хранения всей информации о пользователях, билетах, расписаниях и маршрутах. Взаимодействие осуществляется через драйвер QPSQL фреймворка Qt.
* Формат обмена данными:
  * JSON (JavaScript Object Notation): Легковесный текстовый формат для обмена данными между клиентом и сервером.
